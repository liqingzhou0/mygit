#include<stdio.h>
#include<ctype.h>
#include<string.h>
#define SIZE 20 
int my_atoi(const char *str);
char * s_gets(char *st, int n);

int main(void)
{
	char ch[SIZE];
	printf("Enter the string,line to quit:");
	while(s_gets(ch,SIZE) && ch[0] != '\0') 
	{
		printf("my_atoi整数: %i\n",my_atoi(ch));
		printf("atoi整数   : %i\n",my_atoi(ch));
		printf("Enter the string,line to quit:");
	}
}

int my_atoi(const char *str)
{
	int sum = 0 ;
	int sign = 1 ;
	char ch[] = "0123456789-+";
	while(*str != '\0')
	{
		while(isspace(*str))                               //跳过空白字符。isspace()函数的声明在<ctype.h>头文件里
		{
			str++;
		}
		if(strchr(ch,*str)==NULL)                         //第一个非空白字符不是浮点数字符，则退出循环。strchr()函数的声明在 <string.h>头文件里
			break;
		if(*str == '-' || *str == '+')                   //第一个字符是否为符号           
		{
			if(*str == '-')                             //符号位为负   
			    sign = -1;
			str++;
		}
		while(*str >= '0' && *str <= '9')                //或者用: char ch[]="0123456789"; while(strchr(ch,*str)!=NULL)
		{			 
			sum = sum * 10 + (*str-'0') ;             //整数部分  *str-'0'的值为0到9之间。例如: '9'-'0' == 57-48 == 9
			str++;
		}
	}
	return sum*sign ;                      //单一出口 
}

char * s_gets(char *st, int n)
{
	char * rev_val = NULL ;
	int i = 0 ;
	rev_val = fgets(st,n,stdin);
	if(rev_val != NULL)
	{
		while(st[i] != '\0' && st[i] != '\n')
				i++;
		if(st[i] == '\n')
			st[i] = '\0';
		else
			while(getchar() != '\n')
				continue;
	}
	return rev_val;
}